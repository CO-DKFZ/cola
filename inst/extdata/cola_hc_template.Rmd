Cola report for hierarchical partitioning
==================

**Date**: `r Sys.Date()`

----------------------------------------------------------------

<style type='text/css'>
[% paste(readLines("~/project/development/cola/inst/extdata/custom.css"), collapse = "\n") %]
</style>

```{r, echo = FALSE, message = FALSE}
library(markdown)
options(markdown.HTML.options = setdiff(c(getOption("markdown.HTML.options"), "toc"), "base64_images"))
options(width = 100)
opts_chunk$set(comment = "#>")
opts_chunk$set(fig.path = "figure_cola/")
```

## Summary

All available functions which can be applied to `res` object.

```{r}
[% if(var_name != "res") paste("res =", var_name) %]
res
```

Dimension of the input matrix:

```{r}
dim(res@list[["0"]]@.env$data)
```

Global distribution for each sample:

```{r}
library(ComplexHeatmap)
densityHeatmap(res@list[["0"]]@.env$data, anno = HeatmapAnnotation(df = res@list[["0"]]@known_anno, 
	col = rres@list[["0"]]@known_col), ylab = "value")
```


```{r}
max_depth = max_depth(res)
max_depth
all_nodes = all_nodes(res)
all_nodes
```


```{r}
get_class(res, depth = )
collect_classes(res, depth = )
```

```{r}
dimension_reduction(res, depth)
```

```{r}
get_signature(res, depth = )
```


[% if(!is.null(res_list@list[[1]]@known_anno)) {
	k = res_list@list[[1]]@k
	txt = "Test correlation between subgroups and known annotations:\n\n"
	txt = c(txt, "```{r, results = 'asis', echo = FALSE, include = TRUE}\n")
	txt = c(txt, qq("knitr_add_tab_item('test_to_known_factors(res_list, k = @<k>)', 'k = @<k>')\n", code.pattern = '@<CODE>'))
	txt = c(txt, "knitr_insert_tabs()\n")
	txt = c(txt, "```\n")
	paste(txt, collapse = "\n")
} else {
	""
} %]

## Results for each node

[% 
section_template = paste(readLines("~/project/development/cola/inst/extdata/section_template.Rmd"), collapse = "\n")
section = NULL
for(top_method in res_list@top_method) {
    for(partition_method in res_list@partition_method) {
        section = c(section, qq(section_template))
    }
}
section = c(section, "\n")
paste(section, collapse = "\n\n") %]


## Session info

```{r}
sessionInfo()
```
