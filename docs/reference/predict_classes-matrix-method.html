<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict classes for new samples based on signature centroid matrix — predict_classes-matrix-method • cola</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict classes for new samples based on signature centroid matrix — predict_classes-matrix-method" />
<meta property="og:description" content="Predict classes for new samples based on signature centroid matrix" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cola</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cola.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/cola/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict classes for new samples based on signature centroid matrix</h1>
    
    <div class="hidden name"><code>predict_classes-matrix-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict classes for new samples based on signature centroid matrix</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for matrix</span>
<span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>mat</span>, dist_method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"euclidean"</span>, <span class='st'>"correlation"</span>, <span class='st'>"cosine"</span><span class='op'>)</span>,
    nperm <span class='op'>=</span> <span class='fl'>1000</span>, p_cutoff <span class='op'>=</span> <span class='fl'>0.05</span>, plot <span class='op'>=</span> <span class='cn'>TRUE</span>, col_fun <span class='op'>=</span> <span class='cn'>NULL</span>, split_by_sigatures <span class='op'>=</span> <span class='cn'>FALSE</span>,
    verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, prefix <span class='op'>=</span> <span class='st'>""</span>, mc.cores <span class='op'>=</span> <span class='fl'>1</span>, cores <span class='op'>=</span> <span class='va'>mc.cores</span>, width1 <span class='op'>=</span> <span class='cn'>NULL</span>, width2 <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>The signature centroid matrix. See the Details section.</p></td>
    </tr>
    <tr>
      <th>mat</th>
      <td><p>The new matrix where the classes are going to be predicted. The number of rows should be the same as the signature centroid matrix (also make sure the row orders are the same). Be careful that <code>mat</code> should be in the same scale as the centroid matrix.</p></td>
    </tr>
    <tr>
      <th>dist_method</th>
      <td><p>Distance method. Value should be "euclidean", "correlation" or "cosine".</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>Number of permutatinos. It is used when <code>dist_method</code> is set to "euclidean" or "cosine".</p></td>
    </tr>
    <tr>
      <th>p_cutoff</th>
      <td><p>Cutoff for the p-values for determining class assignment.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Whether to draw the plot that visualizes the process of prediction.</p></td>
    </tr>
    <tr>
      <th>col_fun</th>
      <td><p>A color mapping function generated from <code>colorRamp2</code>. It is set to both heatmaps.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print messages.</p></td>
    </tr>
    <tr>
      <th>split_by_sigatures</th>
      <td><p>Should the heatmaps be split based on k-means on the main heatmap, or on the patterns of the signature heatmap.</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>Used internally.</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>Number of cores. This argument will be removed in future versions.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Number of cores, or a <code>cluster</code> object returned by <code><a href='https://rdrr.io/r/parallel/makeCluster.html'>makeCluster</a></code>.</p></td>
    </tr>
    <tr>
      <th>width1</th>
      <td><p>Width of the first heatmap.</p></td>
    </tr>
    <tr>
      <th>width2</th>
      <td><p>Width of the second heatmap.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The signature centroid matrix is a k-column matrix where each column is the centroid of samples 
in the corresponding class (k-group classification).</p>
<p>For each sample in the new matrix, the task is basically to test which signature centroid the 
current sample is the closest to. There are two methods: the Euclidean distance and the 
correlation (Spearman) distance.</p>
<p>For the Euclidean/cosine distance method, for the vector denoted as x which corresponds to sample i 
in the new matrix, to test which class should be assigned to sample i, the distance between 
sample i and all k signature centroids are calculated and denoted as d_1, d_2, ..., d_k. The class with the smallest distance is assigned to sample i.
The distances for k centroids are sorted increasingly, and we design a statistic named "difference ratio", denoted as r
and calculated as: (|d_(1) - d_(2)|)/mean(d), which is the difference between the smallest distance and the second
smallest distance, normalized by the mean distance. 
To test the statistical significance of r, we randomly permute rows of the signature centroid matrix and calculate r_rand. 
The random permutation is performed <code>n_perm</code> times and the p-value is calculated as the proportion of r_rand being
larger than r.</p>
<p>For the correlation method, the distance is calculated as the Spearman correlation between sample i and signature
centroid k. The label for the class with the maximal correlation value is assigned to sample i. The 
p-value is simply calculated by <code><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></code> between sample i and centroid k.</p>
<p>If a sample is tested with a p-value higher than <code>p_cutoff</code>, the corresponding class label is set to <code>NA</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with two columns: the class labels (the column names of the signature centroid matrix are treated as class labels) and the corresponding p-values.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>golub_cola</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>=</span> <span class='va'>golub_cola</span><span class='op'>[</span><span class='st'>"ATC:skmeans"</span><span class='op'>]</span>
<span class='va'>mat</span> <span class='op'>=</span> <span class='fu'><a href='get_matrix-dispatch.html'>get_matrix</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span>
<span class='co'># note scaling should be applied here because the matrix was scaled in the cola analysis</span>
<span class='va'>mat2</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>mat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>tb</span> <span class='op'>=</span> <span class='fu'><a href='get_signatures-dispatch.html'>get_signatures</a></span><span class='op'>(</span><span class='va'>res</span>, k <span class='op'>=</span> <span class='fl'>3</span>, plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; * 72/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).
#&gt; * cache hash: 6dd0bdce30e1cd9e7f715c58e34e0105 (seed 888).
#&gt; * calculating row difference between subgroups by Ftest.
#&gt; * split rows into 3 groups by k-means clustering.
#&gt; * 2050 signatures (49.8%) under fdr &lt; 0.05, group_diff &gt; 0.</div><div class='input'><span class='va'>sig_mat</span> <span class='op'>=</span> <span class='va'>tb</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"scaled_mean"</span>, <span class='fu'><a href='colnames-dispatch.html'>colnames</a></span><span class='op'>(</span><span class='va'>tb</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>sig_mat</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>sig_mat</span><span class='op'>)</span>
<span class='fu'><a href='colnames-dispatch.html'>colnames</a></span><span class='op'>(</span><span class='va'>sig_mat</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"class"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fu'><a href='ncol-dispatch.html'>ncol</a></span><span class='op'>(</span><span class='va'>sig_mat</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># this is how the signature centroid matrix looks like:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sig_mat</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           class1     class2     class3
#&gt; [1,]  0.53519553 -0.5002490  0.2974125
#&gt; [2,]  0.01991684 -0.3097325  0.7180644
#&gt; [3,]  0.58903898 -0.3514180 -0.1563374
#&gt; [4,]  0.50343231 -0.1528579 -0.4918005
#&gt; [5,] -0.09171790 -0.2294764  0.7145305
#&gt; [6,]  0.02098543 -0.2997821  0.6920673</div><div class='input'>
<span class='va'>mat2</span> <span class='op'>=</span> <span class='va'>mat2</span><span class='op'>[</span><span class='va'>tb</span><span class='op'>$</span><span class='va'>which_row</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>

<span class='co'># now we predict the class for `mat2` based on `sig_mat`</span>
<span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span><span class='op'>(</span><span class='va'>sig_mat</span>, <span class='va'>mat2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>`use_raster` is automatically set to TRUE for a matrix with more than</span>
#&gt; <span class='message'>2000 rows. You can control `use_raster` argument by explicitly setting</span>
#&gt; <span class='message'>TRUE/FALSE to it.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Set `ht_opt$message = FALSE` to turn off this message.</span></div><div class='img'><img src='predict_classes-matrix-method-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;            class p
#&gt; sample_39 class3 0
#&gt; sample_40 class3 0
#&gt; sample_42 class2 0
#&gt; sample_47 class2 0
#&gt; sample_48 class2 0
#&gt; sample_49 class3 0
#&gt; sample_41 class2 0
#&gt; sample_43 class2 0
#&gt; sample_44 class2 0
#&gt; sample_45 class2 0
#&gt; sample_46 class2 0
#&gt; sample_70 class2 0
#&gt; sample_71 class2 0
#&gt; sample_72 class2 0
#&gt; sample_68 class2 0
#&gt; sample_69 class2 0
#&gt; sample_67 class2 0
#&gt; sample_55 class3 0
#&gt; sample_56 class3 0
#&gt; sample_59 class2 0
#&gt; sample_52 class1 0
#&gt; sample_53 class1 0
#&gt; sample_51 class1 0
#&gt; sample_50 class1 0
#&gt; sample_54 class2 0
#&gt; sample_57 class1 0
#&gt; sample_58 class1 0
#&gt; sample_60 class2 0
#&gt; sample_61 class1 0
#&gt; sample_65 class1 0
#&gt; sample_66 class2 0
#&gt; sample_63 class1 0
#&gt; sample_64 class1 0
#&gt; sample_62 class1 0
#&gt; sample_1  class3 0
#&gt; sample_2  class2 0
#&gt; sample_3  class3 0
#&gt; sample_4  class3 0
#&gt; sample_5  class2 0
#&gt; sample_6  class3 0
#&gt; sample_7  class3 0
#&gt; sample_8  class3 0
#&gt; sample_9  class2 0
#&gt; sample_10 class2 0
#&gt; sample_11 class2 0
#&gt; sample_12 class1 0
#&gt; sample_13 class2 0
#&gt; sample_14 class2 0
#&gt; sample_15 class2 0
#&gt; sample_16 class2 0
#&gt; sample_17 class2 0
#&gt; sample_18 class3 0
#&gt; sample_19 class2 0
#&gt; sample_20 class2 0
#&gt; sample_21 class2 0
#&gt; sample_22 class1 0
#&gt; sample_23 class3 0
#&gt; sample_24 class2 0
#&gt; sample_25 class1 0
#&gt; sample_26 class2 0
#&gt; sample_27 class3 0
#&gt; sample_34 class1 0
#&gt; sample_35 class1 0
#&gt; sample_36 class1 0
#&gt; sample_37 class1 0
#&gt; sample_38 class1 0
#&gt; sample_28 class1 0
#&gt; sample_29 class2 0
#&gt; sample_30 class1 0
#&gt; sample_31 class1 0
#&gt; sample_32 class1 0
#&gt; sample_33 class1 0</div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


