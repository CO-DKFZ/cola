<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict classes for new samples based on signature centroid matrix — predict_classes-matrix-method • cola</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict classes for new samples based on signature centroid matrix — predict_classes-matrix-method" />
<meta property="og:description" content="Predict classes for new samples based on signature centroid matrix" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cola</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cola.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cola_quick.html">A Quick Start of cola Package</a>
    </li>
    <li>
      <a href="../articles/functional_enrichment.html">Automatic Functional Enrichment on Signature Genes</a>
    </li>
    <li>
      <a href="../articles/predict.html">Predict classes for new samples</a>
    </li>
    <li>
      <a href="../articles/working_with_big_datasets.html">Working with big datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/cola/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict classes for new samples based on signature centroid matrix</h1>
    
    <div class="hidden name"><code>predict_classes-matrix-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict classes for new samples based on signature centroid matrix</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for matrix</span>
<span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span>(<span class='no'>object</span>, <span class='no'>mat</span>, <span class='kw'>dist_method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"euclidean"</span>, <span class='st'>"correlation"</span>), <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
    <span class='kw'>p_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>The signature centroid matrix. See the Details section.</p></td>
    </tr>
    <tr>
      <th>mat</th>
      <td><p>The new matrix where the classes are going to be predicted. The number of rows should be the same as the signature centroid matrix (also make sure the row orders are the same). Be careful that <code>mat</code> should be in the same scale as the centroid matrix.</p></td>
    </tr>
    <tr>
      <th>dist_method</th>
      <td><p>Distance method. Value should be "euclidean" or "correlation".</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>Number of permutatinos. It is used when <code>dist_method</code> is set to "euclidean".</p></td>
    </tr>
    <tr>
      <th>p_cutoff</th>
      <td><p>Cutoff for the p-values for determining class assignment.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Whether to draw the plot that visualizes the process of prediction.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print messages.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The signature centroid matrix is a k-column matrix where each column is the centroid of samples 
in the corresponding class (k-group classification).</p>
<p>For each sample in the new matrix, the task is basically to test which signature centroid the 
current sample is the closest to. There are two methods: the euclidean distance and the 
correlation (Spearman) distance.</p>
<p>For the euclidean distance method, for the vector denoted as x which corresponds to sample i 
in the new matrix, to test which class should be assigned to sample i, the distance between 
sample i and all k signature centroids are calcualted and denoted as d_1, d_2, ..., d_k. The distances 
for k centroids are sorted increasingly, and we design a statistic named "difference ratio", denoted as r
and calculated as: (|x_(1) - x_(2)|)/mean(x), which is the difference between the smallest distance and the second
smallest distance, normalized by the mean distance. The class with the highest r is assigned to sample i.
To test the statistical significance of r, we randomly permute rows of the signature centroid matrix and calculate r_rand. 
The random permutation is performed <code>n_perm</code> times and the p-value is calculated as the proportion of r_rand being
larger than r.</p>
<p>For the correlation method, the distance is calculated as the Spearman correlation between sample i and signature
centroid k. The label for the class with the maximal correlation value is assigned to sample i. The 
p-value is simply calcualted by <code><a href='https://rdrr.io/r/stats/cor.test.html'>cor.test</a></code> between sample i and centroid k.</p>
<p>If a sample is tested with a p-value less than <code>p_cutoff</code>, the corresponding class label is set to <code>NA</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of class labels (in numeric).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>golub_cola</span>)
<span class='no'>res</span> <span class='kw'>=</span> <span class='no'>golub_cola</span>[<span class='st'>"ATC:skmeans"</span>]
<span class='no'>mat</span> <span class='kw'>=</span> <span class='fu'><a href='get_matrix-dispatch.html'>get_matrix</a></span>(<span class='no'>res</span>)
<span class='co'># note scaling should be applied here because the matrix was scaled in the cola analysis</span>
<span class='no'>mat2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>mat</span>)))

<span class='no'>tb</span> <span class='kw'>=</span> <span class='fu'><a href='get_signatures-ConsensusPartition-method.html'>get_signatures</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; * 70/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).
#&gt; * cache hash: 752a6398cc8385b0a09ab87143cd2a1a (seed 888).
#&gt; * calculating row difference between subgroups by Ftest.
#&gt; * split rows into 2 groups by k-means clustering.
#&gt; * 2074 signatures (50.4%) under fdr &lt; 0.05, group_diff &gt; 0.</div><div class='input'><span class='no'>sig_mat</span> <span class='kw'>=</span> <span class='no'>tb</span>[, <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span>(<span class='st'>"scaled_mean"</span>, <span class='fu'><a href='colnames-dispatch.html'>colnames</a></span>(<span class='no'>tb</span>))]
<span class='no'>sig_mat</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>sig_mat</span>)
<span class='fu'><a href='colnames-dispatch.html'>colnames</a></span>(<span class='no'>sig_mat</span>) <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"class"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='fu'><a href='ncol-dispatch.html'>ncol</a></span>(<span class='no'>sig_mat</span>)))
<span class='co'># this is how the signature centroid matrix looks like:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>sig_mat</span>)</div><div class='output co'>#&gt;          class1     class2     class3
#&gt; [1,]  0.4975305 -0.5891191  0.4262181
#&gt; [2,]  0.1337879 -0.4261118  0.6332715
#&gt; [3,]  0.5535304 -0.3088889 -0.1972277
#&gt; [4,]  0.4513507 -0.1728869 -0.3138483
#&gt; [5,] -0.2650615 -0.1805491  0.7308398
#&gt; [6,] -0.1462731 -0.2171580  0.6310112</div><div class='input'>
<span class='no'>mat2</span> <span class='kw'>=</span> <span class='no'>mat2</span>[<span class='no'>tb</span>$<span class='no'>which_row</span>, , <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>]

<span class='co'># now we predict the class for `mat2` based on `sig_mat`</span>
<span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span>(<span class='no'>sig_mat</span>, <span class='no'>mat2</span>)</div><div class='output co'>#&gt; Predict classes based on 3-group classification.</div><div class='output co'>#&gt; <span class='message'>`use_raster` is automatically set to TRUE for a matrix with more than</span>
#&gt; <span class='message'>2000 rows. You can control `use_raster` argument by explicitly setting</span>
#&gt; <span class='message'>TRUE/FALSE to it.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Set `ht_opt$message = FALSE` to turn off this message.</span></div><div class='img'><img src='predict_classes-matrix-method-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;  [1]  3  3  2  2  2  3  2  2  2  2  2  2  2  2  2  2  2  3  3  2  1  1  1  1  2
#&gt; [26]  1  1  1  1  1  2  1  1  1  3  2  3  3  2  3  3  3  2  3  2  1  2  2  2  2
#&gt; [51]  2  3  2  2  2 NA  3  2  3 NA  3  1  1  1  1  1  1  2  1  1  1  1</div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


