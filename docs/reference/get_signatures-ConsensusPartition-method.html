<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get signature rows — get_signatures-ConsensusPartition-method • cola</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get signature rows — get_signatures-ConsensusPartition-method" />
<meta property="og:description" content="Get signature rows" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cola</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cola.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cola_quick.html">A Quick Start of cola Package</a>
    </li>
    <li>
      <a href="../articles/functional_enrichment.html">Automatic Functional Enrichment on Signature Genes</a>
    </li>
    <li>
      <a href="../articles/predict.html">Predict Classes for New Samples</a>
    </li>
    <li>
      <a href="../articles/work_with_big_datasets.html">Work with Big Datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/cola/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get signature rows</h1>
    
    <div class="hidden name"><code>get_signatures-ConsensusPartition-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get signature rows</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for ConsensusPartition</span>
<span class='fu'><a href='get_signatures-dispatch.html'>get_signatures</a></span>(<span class='no'>object</span>, <span class='no'>k</span>,
    <span class='kw'>silhouette_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
    <span class='kw'>fdr_cutoff</span> <span class='kw'>=</span> <span class='no'>cola_opt</span>$<span class='no'>fdr_cutoff</span>,
    <span class='kw'>top_signatures</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>group_diff</span> <span class='kw'>=</span> <span class='no'>cola_opt</span>$<span class='no'>group_diff</span>,
    <span class='kw'>scale_rows</span> <span class='kw'>=</span> <span class='no'>object</span>@<span class='kw'>scale_rows</span>,
    <span class='kw'>row_km</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>diff_method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Ftest"</span>, <span class='st'>"ttest"</span>, <span class='st'>"samr"</span>, <span class='st'>"pamr"</span>, <span class='st'>"one_vs_others"</span>),
    <span class='kw'>anno</span> <span class='kw'>=</span> <span class='fu'><a href='get_anno-dispatch.html'>get_anno</a></span>(<span class='no'>object</span>),
    <span class='kw'>anno_col</span> <span class='kw'>=</span> <span class='fu'><a href='get_anno_col-dispatch.html'>get_anno_col</a></span>(<span class='no'>object</span>),
    <span class='kw'>internal</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>show_row_dend</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>show_column_names</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>use_raster</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
    <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>888</span>,
    <span class='kw'>left_annotation</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>right_annotation</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
    <span class='kw'>col</span> <span class='kw'>=</span> <span class='kw'>if</span>(<span class='no'>scale_rows</span>) <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"green"</span>, <span class='st'>"white"</span>, <span class='st'>"red"</span>) <span class='kw'>else</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"blue"</span>, <span class='st'>"white"</span>, <span class='st'>"red"</span>),
    <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>prefix</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>enforce</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <code><a href='ConsensusPartition-class.html'>ConsensusPartition-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Number of subgroups.</p></td>
    </tr>
    <tr>
      <th>silhouette_cutoff</th>
      <td><p>Cutoff for silhouette scores. Samples with values  less than it are not used for finding signature rows. For selecting a  proper silhouette cutoff, please refer to <a href='https://www.stat.berkeley.edu/~s133/Cluster2a.html#tth_tAb1.'>https://www.stat.berkeley.edu/~s133/Cluster2a.html#tth_tAb1.</a></p></td>
    </tr>
    <tr>
      <th>fdr_cutoff</th>
      <td><p>Cutoff for FDR of the difference test between subgroups.</p></td>
    </tr>
    <tr>
      <th>top_signatures</th>
      <td><p>Top signatures with most significant fdr. Note since fdr might be same for multiple rows, the final number of signatures might not be exactly the same as the one that has been set.</p></td>
    </tr>
    <tr>
      <th>group_diff</th>
      <td><p>Cutoff for the maximal difference between group means.</p></td>
    </tr>
    <tr>
      <th>scale_rows</th>
      <td><p>Whether apply row scaling when making the heatmap.</p></td>
    </tr>
    <tr>
      <th>row_km</th>
      <td><p>Number of groups for performing k-means clustering on rows. By default it is automatically selected.</p></td>
    </tr>
    <tr>
      <th>diff_method</th>
      <td><p>Methods to get rows which are significantly different between subgroups, see 'Details' section.</p></td>
    </tr>
    <tr>
      <th>anno</th>
      <td><p>A data frame of annotations for the original matrix columns.  By default it uses the annotations specified in <code><a href='consensus_partition.html'>consensus_partition</a></code> or <code><a href='run_all_consensus_partition_methods.html'>run_all_consensus_partition_methods</a></code>.</p></td>
    </tr>
    <tr>
      <th>anno_col</th>
      <td><p>A list of colors (color is defined as a named vector) for the annotations. If <code>anno</code> is a data frame, <code>anno_col</code> should be a named list where names correspond to the column names in <code>anno</code>.</p></td>
    </tr>
    <tr>
      <th>internal</th>
      <td><p>Used internally.</p></td>
    </tr>
    <tr>
      <th>show_row_dend</th>
      <td><p>Whether show row dendrogram.</p></td>
    </tr>
    <tr>
      <th>show_column_names</th>
      <td><p>Whether show column names in the heatmap.</p></td>
    </tr>
    <tr>
      <th>use_raster</th>
      <td><p>Internally used.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Whether to make the plot.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print messages.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Random seed.</p></td>
    </tr>
    <tr>
      <th>left_annotation</th>
      <td><p>Annotation put on the left of the heatmap. It should be a <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation-class.html'>HeatmapAnnotation-class</a></code> object.  The number of items should be the same as the number of the original matrix rows. The subsetting to the significant  rows are automatically performed on the annotation object.</p></td>
    </tr>
    <tr>
      <th>right_annotation</th>
      <td><p>Annotation put on the right of the heatmap. Same format as <code>left_annotation</code>.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>Colors.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>Only used internally.</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>Only used internally.</p></td>
    </tr>
    <tr>
      <th>enforce</th>
      <td><p>The analysis is cached by default, so that the analysis with the same input will be automatically extracted without rerunning them. Set <code>enforce</code> to <code>TRUE</code> to enforce the funtion to re-perform the analysis.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Basically the function applies statistical test for the difference in subgroups for every
row. There are following methods which test significance of the difference:</p>
<dl'>
  <dt>ttest</dt><dd><p>First it looks for the subgroup with highest mean value, compare to each of the  other subgroups with t-test and take the maximum p-value. Second it looks for the subgroup with lowest mean value, compare to each of the other subgroups again with t-test and take the maximum p-values. Later for these two list of p-values take the minimal p-value as the final p-value.</p></dd>
  <dt>samr/pamr</dt><dd><p>use SAM (from samr package)/PAM (from pamr package) method to find significantly different rows between subgroups.</p></dd>
  <dt>Ftest</dt><dd><p>use F-test to find significantly different rows between subgroups.</p></dd>
  <dt>one_vs_others</dt><dd><p>For each subgroup i in each row, it uses t-test to compare samples in current  subgroup to all other samples, denoted as p_i. The p-value for current row is selected as min(p_i).</p></dd>

</dl>

<p><code>diff_method</code> can also be a self-defined function. The function needs two arguments which are the matrix for the analysis
and the predicted classes. The function should returns a vector of FDR from the difference test.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with more than two columns:</p>
<dl'>
  <dt><code>which_row</code>:</dt><dd><p>row index corresponding to the original matrix.</p></dd>
  <dt><code>fdr</code>:</dt><dd><p>the FDR.</p></dd>
  <dt><code>km</code>:</dt><dd><p>the k-means groups if <code>row_km</code> is set.</p></dd>
  <dt>other_columns:</dt><dd><p>the mean value (depending rows are scaled or not) in each subgroup.</p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>golub_cola</span>)
<span class='no'>res</span> <span class='kw'>=</span> <span class='no'>golub_cola</span>[<span class='st'>"ATC"</span>, <span class='st'>"skmeans"</span>]
<span class='no'>tb</span> <span class='kw'>=</span> <span class='fu'><a href='get_signatures-dispatch.html'>get_signatures</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>)</div><div class='output co'>#&gt; * 70/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).
#&gt; * cache hash: d7b0ab9e8457e94218da8307be387574 (seed 888).
#&gt; * calculating row difference between subgroups by Ftest.
#&gt; * split rows into 2 groups by k-means clustering.
#&gt; * 2076 signatures (50.4%) under fdr &lt; 0.05, group_diff &gt; 0.
#&gt;   - randomly sample 2000 signatures.
#&gt; * making heatmaps for signatures.</div><div class='img'><img src='get_signatures-ConsensusPartition-method-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>tb</span>)</div><div class='output co'>#&gt;   which_row          fdr   mean_1   mean_2   mean_3 group_diff scaled_mean_1
#&gt; 1         2 0.0002185571 1.724614 2.073819 2.025161  0.3492051    -0.5519215
#&gt; 2         3 0.0021344643 2.165184 2.263688 2.407486  0.2423019    -0.4025209
#&gt; 3        11 0.0055215848 2.347884 2.528039 2.360294  0.1801552    -0.3077090
#&gt; 4        12 0.0269779019 2.378765 2.539212 2.315479  0.2237332    -0.1548451
#&gt; 5        13 0.0231658067 2.760360 2.793240 3.391696  0.6313355    -0.2048139
#&gt; 6        17 0.0385593480 2.173987 2.401406 2.310037  0.2274190    -0.3427458
#&gt;   scaled_mean_2 scaled_mean_3 km
#&gt; 1    0.52395127     0.3740407  1
#&gt; 2    0.06789322     0.7546084  1
#&gt; 3    0.58853214    -0.2459700  1
#&gt; 4    0.47963596    -0.4051056  1
#&gt; 5   -0.15871813     0.6803041  1
#&gt; 6    0.40763038     0.1061578  1</div><div class='input'><span class='fu'><a href='get_signatures-dispatch.html'>get_signatures</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>top_signatures</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; * 70/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).
#&gt; * cache hash: b67910623ca6b0285a255b432cf9a022 (seed 888).
#&gt; * calculating row difference between subgroups by Ftest.
#&gt; * split rows into 3 groups by k-means clustering.
#&gt; * 100 signatures (2.4%) with most significant fdr, group_diff &gt; 0.
#&gt; * making heatmaps for signatures.</div><div class='img'><img src='get_signatures-ConsensusPartition-method-2.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


