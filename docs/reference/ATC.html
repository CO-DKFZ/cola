<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Ability to correlate to other rows — ATC • cola</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Ability to correlate to other rows — ATC" />
<meta property="og:description" content="Ability to correlate to other rows" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cola</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cola.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cola_quick.html">A Quick Start of cola Package</a>
    </li>
    <li>
      <a href="../articles/functional_enrichment.html">Automatic Functional Enrichment on Signature Genes</a>
    </li>
    <li>
      <a href="../articles/predict.html">Predict Classes for New Samples</a>
    </li>
    <li>
      <a href="../articles/work_with_big_datasets.html">Work with Big Datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/cola/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Ability to correlate to other rows</h1>
    
    <div class="hidden name"><code>ATC.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Ability to correlate to other rows</p>
    </div>

    <pre class="usage"><span class='fu'>ATC</span>(<span class='no'>mat</span>, <span class='kw'>cor_fun</span> <span class='kw'>=</span> <span class='kw pkg'>stat</span><span class='kw ns'>::</span><span class='no'>cor</span>, <span class='kw'>min_cor</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>power</span> <span class='kw'>=</span> <span class='fl'>1</span>,
    <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>n_sampling</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>q_sd</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mat</th>
      <td><p>A numeric matrix. ATC score is calculated by rows.</p></td>
    </tr>
    <tr>
      <th>cor_fun</th>
      <td><p>A function which calculates correlations.</p></td>
    </tr>
    <tr>
      <th>min_cor</th>
      <td><p>Cutoff for the minimal absolute correlation.</p></td>
    </tr>
    <tr>
      <th>power</th>
      <td><p>Power on the correlation values.</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>Number of cores.</p></td>
    </tr>
    <tr>
      <th>n_sampling</th>
      <td><p>When there are too many rows in the matrix, to get the curmulative distribution of how one row correlates other rows, actually we don't need to use all the rows in the matrix, e.g. 1000 rows can already give a very nice estimation.</p></td>
    </tr>
    <tr>
      <th>q_sd</th>
      <td><p>Percentile of the standard deviation for the rows. Rows with values less than it are ignored.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A categorical variable. If it is specified, the correlation is only calculated for the rows in the same group as current row.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Pass to <code>cor_fun</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For a given row in a matrix, the ATC score is the area above the curve of the curmulative density
distribution of the absolute correlation to all other rows. Formally, if <code>F_i(X)</code> is the 
cumulative distribution function of <code>X</code> where <code>X</code> is the absolute correlation for row i with power <code>power</code> (i.e. <code>x = cor^power</code>),
<code>ATC_i = 1 - \int_{min_cor}^1 F_i(X)</code>.</p>
<p>By default the ATC scores are calculated by Pearson correlation, to use Spearman correlation, you can register
a new top-value method by:</p>
<p></p><pre>
    <span class='fu'><a href='register_top_value_methods.html'>register_top_value_methods</a></span>(
        <span class='st'>"ATC_spearman"</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>m</span>) <span class='fu'>ATC</span>(<span class='no'>m</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"spearman"</span>)
    )</pre>

<p>Similarly, to use a robust correlation method, e.g. <code><a href='https://rdrr.io/pkg/WGCNA/man/bicor.html'>bicor</a></code> function, you can do like:</p>
<p></p><pre>
    <span class='fu'><a href='register_top_value_methods.html'>register_top_value_methods</a></span>(
        <span class='st'>"ATC_bicor"</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>m</span>) <span class='fu'>ATC</span>(<span class='no'>m</span>, <span class='kw'>cor_fun</span> <span class='kw'>=</span> <span class='kw pkg'>WGCNA</span><span class='kw ns'>::</span><span class='no'><a href='https://rdrr.io/pkg/WGCNA/man/bicor.html'>bicor</a></span>)
    )</pre>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://jokergoo.github.io/cola_supplementary/suppl_1_ATC/suppl_1_ATC.html'>https://jokergoo.github.io/cola_supplementary/suppl_1_ATC/suppl_1_ATC.html</a></p></div>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of numeric values with the same order as rows in the input matrix.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>12345</span>)
<span class='no'>nr1</span> <span class='kw'>=</span> <span class='fl'>100</span>
<span class='no'>mat1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100</span>*<span class='no'>nr1</span>), <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>nr1</span>)

<span class='no'>nr2</span> <span class='kw'>=</span> <span class='fl'>10</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>mvtnorm</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: mvtnorm</span></div><div class='input'><span class='no'>sigma</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0.8</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>nr2</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>nr2</span>); <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>sigma</span>) <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>mat2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span>(<span class='fl'>100</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>nr2</span>), <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>sigma</span>))

<span class='no'>nr3</span> <span class='kw'>=</span> <span class='fl'>50</span>
<span class='no'>sigma</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fl'>0.5</span>, <span class='kw'>nrow</span> <span class='kw'>=</span> <span class='no'>nr3</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='no'>nr3</span>); <span class='fu'><a href='https://rdrr.io/r/base/diag.html'>diag</a></span>(<span class='no'>sigma</span>) <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>mat3</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html'>rmvnorm</a></span>(<span class='fl'>100</span>, <span class='kw'>mean</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0</span>, <span class='no'>nr3</span>), <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>sigma</span>))

<span class='no'>mat</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='no'>mat1</span>, <span class='no'>mat2</span>, <span class='no'>mat3</span>)
<span class='no'>ATC_score</span> <span class='kw'>=</span> <span class='fu'>ATC</span>(<span class='no'>mat</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>ATC_score</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='no'>nr1</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='no'>nr2</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>, <span class='no'>nr3</span>)))</div><div class='img'><img src='ATC-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


