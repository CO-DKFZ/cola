<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Predict classes for new samples based on cola classification — predict_classes-ConsensusPartition-method • cola</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Predict classes for new samples based on cola classification — predict_classes-ConsensusPartition-method" />
<meta property="og:description" content="Predict classes for new samples based on cola classification" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cola</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cola.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cola_quick.html">A Quick Start of cola Package</a>
    </li>
    <li>
      <a href="../articles/functional_enrichment.html">Automatic Functional Enrichment on Signature Genes</a>
    </li>
    <li>
      <a href="../articles/hierarchical.html">Hierarchical Consensus Partitioning</a>
    </li>
    <li>
      <a href="../articles/predict.html">Predict Classes for New Samples</a>
    </li>
    <li>
      <a href="../articles/work_with_big_datasets.html">Work with Big Datasets</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/cola/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict classes for new samples based on cola classification</h1>
    
    <div class="hidden name"><code>predict_classes-ConsensusPartition-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict classes for new samples based on cola classification</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for ConsensusPartition</span>
<span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span>(<span class='no'>object</span>, <span class='no'>k</span>, <span class='no'>mat</span>,
    <span class='kw'>silhouette_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
    <span class='kw'>fdr_cutoff</span> <span class='kw'>=</span> <span class='no'>cola_opt</span>$<span class='no'>fdr_cutoff</span>,
    <span class='kw'>group_diff</span> <span class='kw'>=</span> <span class='no'>cola_opt</span>$<span class='no'>group_diff</span>,
    <span class='kw'>scale_rows</span> <span class='kw'>=</span> <span class='no'>object</span>@<span class='kw'>scale_rows</span>,
    <span class='kw'>diff_method</span> <span class='kw'>=</span> <span class='st'>"Ftest"</span>,
    <span class='kw'>dist_method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"euclidean"</span>, <span class='st'>"correlation"</span>, <span class='st'>"cosine"</span>), <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
    <span class='kw'>p_cutoff</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>force</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>help</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>prefix</span> <span class='kw'>=</span> <span class='st'>""</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <code><a href='ConsensusPartition-class.html'>ConsensusPartition-class</a></code> object.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>Number of subgroups to get the classifications.</p></td>
    </tr>
    <tr>
      <th>mat</th>
      <td><p>The new matrix where the sample classes are going to be predicted. The number of rows should be the same as the original matrix for cola analysis (also make sure the row orders are the same). Be careful that the scaling of <code>mat</code> should be the same as that applied in cola analysis.</p></td>
    </tr>
    <tr>
      <th>silhouette_cutoff</th>
      <td><p>Send to <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code> for determining signatures.</p></td>
    </tr>
    <tr>
      <th>fdr_cutoff</th>
      <td><p>Send to <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code> for determining signatures.</p></td>
    </tr>
    <tr>
      <th>group_diff</th>
      <td><p>Send to <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code> for determining signatures.</p></td>
    </tr>
    <tr>
      <th>scale_rows</th>
      <td><p>Send to <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code> for determining signatures.</p></td>
    </tr>
    <tr>
      <th>diff_method</th>
      <td><p>Send to <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code> for determining signatures.</p></td>
    </tr>
    <tr>
      <th>dist_method</th>
      <td><p>Distance method. Value should be "euclidean", "correlation" or "cosine". Send to <code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code>.</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>Number of permutatinos. It is used when <code>dist_method</code> is set to "euclidean" or "cosine". Send to <code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code>.</p></td>
    </tr>
    <tr>
      <th>p_cutoff</th>
      <td><p>Cutoff for the p-values for determining class assignment. Send to <code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code>.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Whether to draw the plot that visualizes the process of prediction. Send to <code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code>.</p></td>
    </tr>
    <tr>
      <th>force</th>
      <td><p>If the value is <code>TRUE</code> and when <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code> internally failed, top 1000 rows with the highest between-group mean difference are used for constructing the signature centroid matrix. It is basically used internally.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Whether to print messages. Send to <code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code>.</p></td>
    </tr>
    <tr>
      <th>help</th>
      <td><p>Whether to print help messages.</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>Used internally.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The prediction is based on the signature centroid matrix from cola classification. The processes are as follows:</p>
<p>1. For the provided <code><a href='ConsensusPartition-class.html'>ConsensusPartition-class</a></code> object and a selected k, the signatures that discriminate classes
   are extracted by <code><a href='get_signatures-ConsensusPartition-method.html'>get_signatures,ConsensusPartition-method</a></code>. If number of signatures is more than 2000, only 2000 signatures are randomly sampled.
2. The signature centroid matrix is a k-column matrix where each column is the centroid of samples in the corresponding
   class, i.e. the mean across samples. If rows were scaled in cola analysis, the signature centroid matrix is the mean of scaled
   values and vise versa. Please note the samples with silhouette score less than <code>silhouette_cutoff</code> are removed
   for calculating the centroids.
3. With the signature centroid matrix and the new matrix, it calls <code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code> to perform the prediction.
   Please see more details of the prediction on that help page. Please note, the scales of the new matrix should be the same as the matrix
   used for cola analysis.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame with two columns: the class labels (in numeric) and the corresponding p-values.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predict_classes-matrix-method.html'>predict_classes,matrix-method</a></code> that predicts the classes for new samples.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>golub_cola</span>)
<span class='no'>res</span> <span class='kw'>=</span> <span class='no'>golub_cola</span>[<span class='st'>"ATC:skmeans"</span>]
<span class='no'>mat</span> <span class='kw'>=</span> <span class='fu'><a href='get_matrix-dispatch.html'>get_matrix</a></span>(<span class='no'>res</span>)
<span class='co'># note scaling should be applied here because the matrix was scaled in the cola analysis</span>
<span class='no'>mat2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>mat</span>)))
<span class='no'>cl</span> <span class='kw'>=</span> <span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='no'>mat2</span>)</div><div class='output co'>#&gt; The matrix has been scaled in cola analysis, thus the new matrix should
#&gt; also be scaled with the same method ('z-score'). Please double check.
#&gt; Set `help = FALSE` to suppress this message. 
#&gt; 
#&gt; * 70/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).
#&gt; * cache hash: d7b0ab9e8457e94218da8307be387574 (seed 888).
#&gt; * calculating row difference between subgroups by Ftest.
#&gt; * split rows into 4 groups by k-means clustering.
#&gt; * 2076 signatures (50.4%) under fdr &lt; 0.05, group_diff &gt; 0.
#&gt; Predict classes based on 3-group classification (euclidean method) on a 72-column matrix.</div><div class='img'><img src='predict_classes-ConsensusPartition-method-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># compare the real classification and the predicted classification</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>cola_class</span> <span class='kw'>=</span> <span class='fu'><a href='get_classes-dispatch.html'>get_classes</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>)[, <span class='st'>"class"</span>],
           <span class='kw'>predicted</span> <span class='kw'>=</span> <span class='no'>cl</span>[, <span class='st'>"class"</span>])</div><div class='output co'>#&gt;    cola_class predicted
#&gt; 1           3         3
#&gt; 2           3         3
#&gt; 3           1         1
#&gt; 4           1         1
#&gt; 5           1         1
#&gt; 6           3         3
#&gt; 7           1         1
#&gt; 8           1         1
#&gt; 9           1         1
#&gt; 10          1         1
#&gt; 11          1         1
#&gt; 12          1         1
#&gt; 13          1         1
#&gt; 14          1         1
#&gt; 15          1         1
#&gt; 16          1         1
#&gt; 17          1         1
#&gt; 18          3         3
#&gt; 19          3         3
#&gt; 20          1         1
#&gt; 21          2         2
#&gt; 22          2         2
#&gt; 23          2         2
#&gt; 24          2         2
#&gt; 25          1         1
#&gt; 26          2         2
#&gt; 27          2         2
#&gt; 28          2         2
#&gt; 29          2         2
#&gt; 30          2         2
#&gt; 31          1         1
#&gt; 32          2         2
#&gt; 33          2         2
#&gt; 34          2         2
#&gt; 35          3         3
#&gt; 36          1         1
#&gt; 37          3         3
#&gt; 38          3         3
#&gt; 39          1         1
#&gt; 40          3         3
#&gt; 41          3         3
#&gt; 42          3         3
#&gt; 43          1         1
#&gt; 44          3         3
#&gt; 45          1         1
#&gt; 46          2         2
#&gt; 47          1         1
#&gt; 48          1         1
#&gt; 49          1         1
#&gt; 50          1         1
#&gt; 51          1         1
#&gt; 52          3         3
#&gt; 53          1         1
#&gt; 54          1         1
#&gt; 55          1         1
#&gt; 56          2         2
#&gt; 57          3         3
#&gt; 58          1         1
#&gt; 59          3         2
#&gt; 60          1         1
#&gt; 61          3         3
#&gt; 62          2         2
#&gt; 63          2         2
#&gt; 64          2         2
#&gt; 65          2         2
#&gt; 66          2         2
#&gt; 67          2         2
#&gt; 68          1         1
#&gt; 69          2         2
#&gt; 70          2         2
#&gt; 71          2         2
#&gt; 72          2         2</div><div class='input'><span class='co'># change to correlation method</span>
<span class='no'>cl</span> <span class='kw'>=</span> <span class='fu'><a href='predict_classes-dispatch.html'>predict_classes</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='no'>mat2</span>, <span class='kw'>dist_method</span> <span class='kw'>=</span> <span class='st'>"correlation"</span>)</div><div class='output co'>#&gt; The matrix has been scaled in cola analysis, thus the new matrix should
#&gt; also be scaled with the same method ('z-score'). Please double check.
#&gt; Set `help = FALSE` to suppress this message. 
#&gt; 
#&gt; * 70/72 samples (in 3 classes) remain after filtering by silhouette (&gt;= 0.5).
#&gt; * cache hash: d7b0ab9e8457e94218da8307be387574 (seed 888).
#&gt; * calculating row difference between subgroups by Ftest.
#&gt;   - row difference is extracted from cache.
#&gt; * use k-means partition that are already calculated in previous runs.
#&gt; * 2076 signatures (50.4%) under fdr &lt; 0.05, group_diff &gt; 0.
#&gt; Predict classes based on 3-group classification (correlation method) on a 72-column matrix.</div><div class='img'><img src='predict_classes-ConsensusPartition-method-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># compare the real classification and the predicted classification</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>cola_class</span> <span class='kw'>=</span> <span class='fu'><a href='get_classes-dispatch.html'>get_classes</a></span>(<span class='no'>res</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>)[, <span class='st'>"class"</span>],
           <span class='kw'>predicted</span> <span class='kw'>=</span> <span class='no'>cl</span>[, <span class='st'>"class"</span>])</div><div class='output co'>#&gt;    cola_class predicted
#&gt; 1           3         3
#&gt; 2           3         3
#&gt; 3           1         1
#&gt; 4           1         1
#&gt; 5           1         1
#&gt; 6           3         3
#&gt; 7           1         1
#&gt; 8           1         1
#&gt; 9           1         1
#&gt; 10          1         1
#&gt; 11          1         1
#&gt; 12          1         1
#&gt; 13          1         1
#&gt; 14          1         1
#&gt; 15          1         1
#&gt; 16          1         1
#&gt; 17          1         1
#&gt; 18          3         3
#&gt; 19          3         3
#&gt; 20          1         1
#&gt; 21          2         2
#&gt; 22          2         2
#&gt; 23          2         2
#&gt; 24          2         2
#&gt; 25          1         1
#&gt; 26          2         2
#&gt; 27          2         2
#&gt; 28          2         2
#&gt; 29          2         2
#&gt; 30          2         2
#&gt; 31          1         1
#&gt; 32          2         2
#&gt; 33          2         2
#&gt; 34          2         2
#&gt; 35          3         3
#&gt; 36          1         1
#&gt; 37          3         3
#&gt; 38          3         3
#&gt; 39          1         1
#&gt; 40          3         3
#&gt; 41          3         3
#&gt; 42          3         3
#&gt; 43          1         1
#&gt; 44          3         3
#&gt; 45          1         1
#&gt; 46          2         2
#&gt; 47          1         1
#&gt; 48          1         1
#&gt; 49          1         1
#&gt; 50          1         1
#&gt; 51          1         1
#&gt; 52          3         3
#&gt; 53          1         1
#&gt; 54          1         1
#&gt; 55          1         1
#&gt; 56          2         2
#&gt; 57          3         3
#&gt; 58          1         1
#&gt; 59          3         2
#&gt; 60          1         1
#&gt; 61          3         3
#&gt; 62          2         2
#&gt; 63          2         2
#&gt; 64          2         2
#&gt; 65          2         2
#&gt; 66          2         2
#&gt; 67          2         2
#&gt; 68          1         1
#&gt; 69          2         2
#&gt; 70          2         2
#&gt; 71          2         2
#&gt; 72          2         2</div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


